@{
    var FullName = Context.Session.GetString("FullName") ?? "Guest";
}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - DoctorNurse Dashboard</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/admindashboard.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/doctornurse.css" asp-append-version="true" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="sidebar text-black text-center bg-primary border-2 shadow-sm">
       @*  <img src="~/Images/alah.png" alt="Alternate Text" class="img-fluid mb-2" style="width: 60%; height: 150px; object-fit: cover;" /> *@

        <div style="position: relative; display: inline-block;">
            <img id="doctorprofileImage" src="~/Images/patientimage.png" alt="Profile Image" style="width: 150px; height: 150px; border-radius: 10px; object-fit: cover; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);" />
            <i class="bi bi-pencil-square" onclick="document.getElementById('imageUpload').click()" style="position: absolute; top: 10px; right: 10px; font-size: 24px; color: #ffffff; cursor: pointer; background-color: #007bff; border-radius: 50%; padding: 4px;"></i>
            <input type="file" id="imageUpload" style="display: none;" onchange="uploadImage()" />
        </div>

        @if (!string.IsNullOrEmpty(FullName))
        {
            <h4 class="text-center text-white mb-4">@FullName</h4>
        }

        <a href="@Url.Action("DoctorNurseDashboard", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-toggles"></i> Dashboard
        </a>

        <a href="@Url.Action("ViewAppointments", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-eye"></i> View Appointments
        </a>

        <a href="@Url.Action("ManagePatients", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-person-gear"></i> Manage Patients
        </a>

        <a href="@Url.Action("", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-file-earmark-text"></i> Reports
        </a>

        <a href="@Url.Action("Chatdoctornurse", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-chat-left-text-fill"></i> Chat
        </a>

        <a href="@Url.Action("DoctorNurseEvent", "DoctorNurse")" class="sidebar-link text-white py-2">
            <i class="bi bi-calendar-event-fill"></i> Event
        </a>

        <a href="@Url.Action("Index", "Home")" class="sidebar-link text-white py-2">
            <i class="bi bi-arrow-bar-right"></i> Logout
        </a>
    </div>


    <div id="content" class="content position-relative" style="background-color: lightgoldenrodyellow; min-height: 100vh;">
        <header class="header bg-white border-bottom shadow-sm">
            <div class="container-fluid d-flex">
                <h5 class="d-flex p-1" style="font-size:28px;">Welcome, <span class="text-primary">@FullName</span></h5>
                <div class="d-flex" style="margin-left:650px;">
                    <i class="bi bi-bell d-flex align-items-center justify-content-center shadow-sm rounded-circle p-2 mx-1" style="width: 40px; height: 40px; background-color:lightblue; cursor:pointer;"></i>
                    <i id="toggleTheme" class="bi bi-moon d-flex align-items-center justify-content-center shadow-sm rounded-circle p-2 mx-1" style="width: 40px; height: 40px; background-color:lightblue;cursor: pointer;"></i>
                    <img src="~/Images/alah.png" alt="Alternate Text" class="align-items-center justify-content-center shadow-sm rounded-circle" style="width: 60px; height: 50px; margin-left:40px;" />
                </div>
            </div>
        </header>


        <main role="main" class="container">
            @RenderBody()
        </main>

        <footer class="footer">
            <div class="container">
                <span>&copy; 2024 - HealthBridge Admin</span>
            </div>
        </footer>
    </div>


    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    @RenderSection("Scripts", required: false)

    <script>
        document.getElementById('toggleTheme').addEventListener('click', function () {
            var contentDiv = document.getElementById('content');
            contentDiv.style.backgroundColor = contentDiv.style.backgroundColor === 'lightblue' ? 'lightgoldenrodyellow' : 'lightblue';
            //contentDiv.style.color = contentDiv.style.color === 'white' ? 'black' : 'white';
        });

        function loadProfileImage() {
            var profileImageUrl = localStorage.getItem("ProfileImage");
            if (profileImageUrl) {
                document.getElementById("doctorprofileImage").src = profileImageUrl;
            }
        }

        window.onload = loadProfileImage;



        function uploadImage() {
            var userId = localStorage.getItem("UserId");
            var fileInput = document.getElementById("imageUpload");

            var formData = new FormData();
            formData.append("doctorprofileImage", fileInput.files[0]);
            formData.append("userId", userId);

            $.ajax({
                url: '@Url.Action("DoctorUploadProfileImage", "DoctorNurse")',
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function (response) {
                    if (response.success) {
                        localStorage.setItem("ProfileImage", response.imageUrl);
                        document.getElementById("doctorprofileImage").src = response.imageUrl;
                        alert("Image uploaded successfully!");
                    } else {
                        alert("Image upload failed. Please try again.");
                    }
                },
                error: function () {
                    alert("An error occurred while uploading the image.");
                }
            });
        }
    </script>
</body>
</html>